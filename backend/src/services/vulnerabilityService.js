const vulnerabilityModel = require('../models/vulnerabilityModel');

async function getAll() {
  const vulnerabilities = await vulnerabilityModel.findAll();
  return vulnerabilities || [];
}

async function getByCode(code) {
  const vulnerability = await vulnerabilityModel.findByCode(code);

  if (!vulnerability) {
    throw new Error('Vulnerability not found');
  }

  return vulnerability;
}

module.exports = {
  getAll,
  getByCode
};
