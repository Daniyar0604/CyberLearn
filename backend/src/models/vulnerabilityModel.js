const db = require('../config/db');

async function findAll() {
  const [rows] = await db.query(`
    SELECT id, code, title, description, is_frozen
    FROM vulnerabilities
    ORDER BY id
  `);

  return rows;
}

async function findByCode(code) {
  const [rows] = await db.query(
    `
    SELECT id, code, title, description, is_frozen
    FROM vulnerabilities
    WHERE code = ?
    LIMIT 1
  `,
    [code]
  );

  return rows[0];
}

module.exports = {
  findAll,
  findByCode
};
